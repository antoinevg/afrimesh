; extensions.conf - the Asterisk dial plan

[general]

static=yes
writeprotect=no
clearglobalvars=no


[globals]


[main-menu]
exten => 9999,1,Answer
exten => 9999,2,Background(welcome-ivr-menu)
exten => 9999,3,Background(mp-menu)
exten => 9999,4,Background(silence/10)
exten => 9999,5,Hangup

exten => 1,1,Goto(easysetup,73887,1)                             
exten => 2,1,Goto(default,3427,1)                                    
exten => 3,1,Goto(default,2661,1)                                    
exten => 4,1,Goto(default,2664,1)                                    
exten => 5,1,Goto(default,2663,1)                                    
exten => 6,1,Goto(default,7774,1)                                    
exten => 7,1,Goto(9999,2) 



[default]

exten => 6368,1,Goto(main-menu,9999,1)
exten => 4000,1,Dial(MP/1)
exten => 4001,1,Answer
exten => 4001,2,Echo
exten => 4002,1,Dial(SIP/sipguest)

; 1,2 or 3 digit dialling of last octet

exten => _X,1,Dial(SIP/4000@10.130.1.${EXTEN})
exten => _X,2,System(/www/cgi-bin/notify ${EXTEN} ${CHANNEL} ${TRUNK} >> /tmp/notify.log 2>&1)
exten => _XX,1,Dial(SIP/4000@10.130.1.${EXTEN})
exten => _XX,2,System(/www/cgi-bin/notify ${EXTEN} ${CHANNEL} ${TRUNK} >> /tmp/notify.log 2>&1)
exten => _XXX,1,Dial(SIP/4000@10.130.1.${EXTEN})
exten => _XXX,2,System(/www/cgi-bin/notify ${EXTEN} ${CHANNEL} ${TRUNK} >> /tmp/notify.log 2>&1)

; full a*b*c*d IP dialling, e.g. 10*130*1*144*

exten => _X.,1,Set(OCTETS=${EXTEN})
exten => _X.,n,Set(IP=${CUT(OCTETS,*,1)}.${CUT(OCTETS,*,2)}.${CUT(OCTETS,*,3)}.${CUT(OCTETS,*,4)})
exten => _X.,n,Dial(SIP/4000@${IP})

; Read out Wireless IP
exten => 2661,1,Answer                                                                                                 
exten => 2661,2,Background(read-ath0-ip)                                                                                   
exten => 2661,3,System(/bin/getathip)                                                              
exten => 2661,4,ReadFile(octet=/tmp/octet1,15)
exten => 2661,5,SayNumber(${octet})
exten => 2661,6,SayAlpha(.)
exten => 2661,7,ReadFile(octet=/tmp/octet2,15)
exten => 2661,8,SayNumber(${octet}) 
exten => 2661,9,SayAlpha(.)
exten => 2661,10,ReadFile(octet=/tmp/octet3,15)
exten => 2661,11,SayNumber(${octet})
exten => 2661,12,SayAlpha(.) 
exten => 2661,13,ReadFile(octet=/tmp/octet4,15)
exten => 2661,14,SayNumber(${octet})   
exten => 2661,15,Playback(privacy-thankyou)

; C-O-N-F -> 2663 to set the IP of this IP04

exten => 2663,1,Answer
exten => 2663,2,Playback(enter-ip)
exten => 2663,3,Read(newip||15)
exten => 2663,4,SayDigits(${newip})
exten => 2663,5,System(/bin/echo "${newip}" > /tmp/newip.txt)
exten => 2663,6,System(/bin/setnewip)

; Read out Ethernet IP
exten => 2664,1,Answer                                                                          
exten => 2664,2,Background(read-eth0-ip)                                                                                
exten => 2664,3,System(/bin/getethip)                                       
exten => 2664,4,ReadFile(octet=/tmp/octet1,15)                                                         
exten => 2664,5,SayNumber(${octet})                                               
exten => 2664,6,SayAlpha(.)                                  
exten => 2664,7,ReadFile(octet=/tmp/octet2,15)                                               
exten => 2664,8,SayNumber(${octet}) 
exten => 2664,9,SayAlpha(.)                                  
exten => 2664,10,ReadFile(octet=/tmp/octet3,15)                                                                        
exten => 2664,11,SayNumber(${octet})                                                    
exten => 2664,12,SayAlpha(.)                                                                                      
exten => 2664,13,ReadFile(octet=/tmp/octet4,15)                            
exten => 2664,14,SayNumber(${octet})                                              
exten => 2664,15,Playback(privacy-thankyou)   

; Start DHCP from phone
exten => 3427,1,Answer 
exten => 3427,2,SayAlpha(dhcp) 
exten => 3427,3,System(udhcpc -i eth0 &) 
exten => 3427,4,Wait(4) 
exten => 3427,5,System(/bin/getethip)                                                        
exten => 3427,6,ReadFile(octet=/tmp/octet1,15)                                    
exten => 3427,7,SayNumber(${octet})                      
exten => 3427,8,SayAlpha(.)                                                                                            
exten => 3427,9,ReadFile(octet=/tmp/octet2,15)                                          
exten => 3427,10,SayNumber(${octet})                                                                               
exten => 3427,11,SayAlpha(.)                                                
exten => 3427,12,ReadFile(octet=/tmp/octet3,15)                                   
exten => 3427,13,SayNumber(${octet})                     
exten => 3427,14,SayAlpha(.)                                                                       
exten => 3427,15,ReadFile(octet=/tmp/octet4,15)           
exten => 3427,16,SayNumber(${octet})                             
exten => 3427,17,Playback(privacy-thankyou)

;rssi - read out signal strength

exten => 7774,1,Answer
exten => 7774,2,Playback(rssi)
exten => 7774,3,System(/bin/rssi.sh)
exten => 7774,4,ReadFile(rssi=/tmp/rssi)
exten => 7774,5,SayNumber(${rssi})
exten => 7774,6,Goto(7774,3)

#include "potato.extensions.conf"


[easysetup]
exten => 73887,1,Answer                                                                           
exten => 73887,2,Background(easy-setup)                                                             
exten => 73887,3,Background(silence/9)                       
exten => 73887,4,Playback(privacy-thankyou)                   
exten => 73887,5,Hangup      
exten => 1,1,System(/bin/meshclientgw.sh)
exten => 1,2,Hangup()
exten => 2,1,System(/bin/meshgw.sh)
exten => 2,2,Hangup()
exten => 3,1,System(/bin/wireless_client.sh)
exten => 3,2,Hangup()
exten => 4,1,System(accesspoint.sh)                                                                                        
exten => 4,2,Hangup()
exten => 5,1,Goto(easysetup,73887,2)                                                                                        
exten => 5,2,Hangup()

     

